---
- name:  Provision a machine to run Tryton server
  hosts: tryton
  roles:
    - role: users
      tags: users

    - role: system_packages
      tags: system

    - role: geerlingguy.postgresql
      tags: database
      become: yes
      vars:
        postgresql_locales:
          '{{ db_locales }}'

    # This role is to allow create user and database without install PostgreSQL
    - role: postgres_configuration
      tags: database
      become: yes

    - role: lciolecki.virtualenvwrapper
      #tags: virtualenv
      vars:
        virtualenvwrapper_version: '4.3.1'
        virtualenvwrapper_python: /usr/bin/python
        virtualenvwrapper_virtualenv: /usr/local/bin/virtualenv
        virtualenvwrapper_source: /usr/local/bin/virtualenvwrapper.sh
        virtualenvwrapper_home: '/home/{{ tryton_user }}/.virtualenvs/'
        virtualenvwrapper_project: '/home/{{ tryton_user }}/projects/'
        virtualenvwrapper_shell_file: '/home/{{ tryton_user }}/.bashrc'

    - role: virtualenv
      tags: virtualenv

    - role: tryton_configuration_files
      tags: config
